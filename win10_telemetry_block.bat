я»ї:: добавляем хосты в hosts

echo 127.0.0.1 a.ads2.msads.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a.rad.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0002.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0003.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0004.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0005.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0006.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0007.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0008.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a-0009.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ac3.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 adnexus.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 adnxs.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 aidps.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 aka-cdn-ns.adtech.de >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 apps.skype.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 b.ads1.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 b.ads2.msads.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 b.rad.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 bs.serving-sys.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 c.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 c.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ca.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 cache.datamart.windows.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 cdn.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 cds26.ams9.msecn.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 compatexchange.cloudapp.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 corp.sts.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 db3aqu.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 db3wns2011111.wns.windows.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ec.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 fe3.delivery.dsp.mp.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 flex.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 g.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 h1.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 i1.services.social.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 lb1.www.ms.akadns.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 live.rads.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 m.adnxs.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 m.hotmail.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 msftncsi.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 msnbot-207-46-194-33.search.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 msnbot-65-55-108-23.search.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 msntest.serving-sys.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 oca.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 oca.telemetry.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 pricelist.skype.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 rad.live.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 rad.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 s.gateway.messenger.live.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 s0.2mdn.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 schemas.microsoft.akadns.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 secure.adnxs.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 secure.flashtalking.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 settings.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 settings-win.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 sO.2mdn.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 spynet2.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 spynetalt.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 sqm.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 sqm.telemetry.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ssw.live.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 static.2mdn.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 statsfe2.update.microsoft.com.akadns.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telecommand.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telecommand.telemetry.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telecommand.telemetry.microsoft.com.nsatВнc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telemetry.appex.bing.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telemetry.appex.bing.net:443 >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ui.skype.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 v10.vortex-win.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 view.atdmt.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex-bn2.metron.live.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex-cy2.metron.live.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex-win.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 watson.telemetry.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 www.msftncsi.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 watson.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 redir.metaservices.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 choice.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 choice.microsoft.com.nsatc.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 reports.wes.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 wes.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 services.wes.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 sqm.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 watson.ppe.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 telemetry.urs.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 settings-sandbox.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex-sandbox.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 survey.watson.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 watson.live.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 watson.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 statsfe2.ws.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 corpext.msitadfs.glbdns2.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
:: echo 127.0.0.1 cs1.wpc.v0cdn.net >> C:\Windows\System32\drivers\etc\hosts - ломает установку расширений vscode
echo 127.0.0.1 a-0001.a-msedge.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 sls.update.microsoft.com.akadns.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 fe2.update.microsoft.com.akadns.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 diagnostics.support.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 statsfe1.ws.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 pre.footprintpredict.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 i1.services.social.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 feedback.windows.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 feedback.microsoft-hohm.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 feedback.search.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 preview.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ad.doubleclick.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ads.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ads1.msads.net>> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 ads1.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a.ads1.msn.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 a.ads2.msn.com >> C:\Windows\System32\drivers\etc\hosts
:: echo 127.0.0.1 az361816.vo.msecnd.net >> C:\Windows\System32\drivers\etc\hosts - ломает установку расширений vscode
echo 127.0.0.1 az512334.vo.msecnd.net >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 pre.footprintpredict.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 reports.wes.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 reports.wes.df.telemetry.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 vortex-sandbox.data.microsoft.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 pre.footprintpredict.com >> C:\Windows\System32\drivers\etc\hosts
echo 127.0.0.1 i1.services.social.microsoft.com >> C:\Windows\System32\drivers\etc\hosts

:: определяем параметры для firewall
:: блокируем исходящие подключения

netsh advfirewall firewall add rule name="telemetry_104.96.147.3" dir=out action=block remoteip=104.96.147.3 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.30.202" dir=out action=block remoteip=134.170.30.202 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.165.248" dir=out action=block remoteip=134.170.165.248 enable=yes
netsh advfirewall firewall add rule name="telemetry_137.116.81.24" dir=out action=block remoteip=137.116.81.24 enable=yes
netsh advfirewall firewall add rule name="telemetry_137.117.235.16" dir=out action=block remoteip=137.117.235.16 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.165.253" dir=out action=block remoteip=134.170.165.253 enable=yes
netsh advfirewall firewall add rule name="telemetry_111.221.29.253" dir=out action=block remoteip=111.221.29.253 enable=yes
netsh advfirewall firewall add rule name="telemetry_111.221.64.0-111.221.127.255" dir=out action=block remoteip=111.221.64.0-111.221.127.255 enable=yes
netsh advfirewall firewall add rule name="telemetry_131.253.40.37" dir=out action=block remoteip=131.253.40.37 enable=yes
netsh advfirewall firewall add rule name="telemetry_vortex.data.microsoft.com" dir=out action=block remoteip=191.232.139.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_telecommand.telemetry.microsoft.com" dir=out action=block remoteip=65.55.252.92 enable=yes
netsh advfirewall firewall add rule name="telemetry_sqm.telemetry.microsoft.com" dir=out action=block remoteip=65.55.252.93 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.telemetry.microsoft.com" dir=out action=block remoteip=65.55.252.43,65.52.108.29 enable=yes
netsh advfirewall firewall add rule name="telemetry_redir.metaservices.microsoft.com" dir=out action=block remoteip=194.44.4.200,194.44.4.208 enable=yes
netsh advfirewall firewall add rule name="telemetry_choice.microsoft.com" dir=out action=block remoteip=157.56.91.77 enable=yes
netsh advfirewall firewall add rule name="telemetry_df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.7 enable=yes
netsh advfirewall firewall add rule name="telemetry_reports.wes.df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.91 enable=yes
netsh advfirewall firewall add rule name="telemetry_wes.df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.93 enable=yes
netsh advfirewall firewall add rule name="telemetry_services.wes.df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.92 enable=yes
netsh advfirewall firewall add rule name="telemetry_sqm.df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.94 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.9 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.ppe.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.11 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.appex.bing.net" dir=out action=block remoteip=168.63.108.233 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.urs.microsoft.com" dir=out action=block remoteip=157.56.74.250 enable=yes
netsh advfirewall firewall add rule name="telemetry_settings-sandbox.data.microsoft.com" dir=out action=block remoteip=111.221.29.177 enable=yes
netsh advfirewall firewall add rule name="telemetry_vortex-sandbox.data.microsoft.com" dir=out action=block remoteip=64.4.54.32 enable=yes
netsh advfirewall firewall add rule name="telemetry_survey.watson.microsoft.com" dir=out action=block remoteip=207.68.166.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.live.com" dir=out action=block remoteip=207.46.223.94 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.microsoft.com" dir=out action=block remoteip=65.55.252.71 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe2.ws.microsoft.com" dir=out action=block remoteip=64.4.54.22 enable=yes
netsh advfirewall firewall add rule name="telemetry_corpext.msitadfs.glbdns2.microsoft.com" dir=out action=block remoteip=131.107.113.238 enable=yes
netsh advfirewall firewall add rule name="telemetry_compatexchange.cloudapp.net" dir=out action=block remoteip=23.99.10.11 enable=yes
:: netsh advfirewall firewall add rule name="telemetry_cs1.wpc.v0cdn.net" dir=out action=block remoteip=68.232.34.200 enable=yes - ломает установку расширений vscode
netsh advfirewall firewall add rule name="telemetry_a-0001.a-msedge.net" dir=out action=block remoteip=204.79.197.200 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe2.update.microsoft.com.akadns.net" dir=out action=block remoteip=64.4.54.22 enable=yes
netsh advfirewall firewall add rule name="telemetry_sls.update.microsoft.com.akadns.net" dir=out action=block remoteip=157.56.77.139 enable=yes
netsh advfirewall firewall add rule name="telemetry_fe2.update.microsoft.com.akadns.net" dir=out action=block remoteip=134.170.58.121,134.170.58.123,134.170.53.29,66.119.144.190,134.170.58.189,134.170.58.118,134.170.53.30,134.170.51.190 enable=yes
netsh advfirewall firewall add rule name="telemetry_diagnostics.support.microsoft.com" dir=out action=block remoteip=157.56.121.89 enable=yes
netsh advfirewall firewall add rule name="telemetry_corp.sts.microsoft.com" dir=out action=block remoteip=131.107.113.238 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe1.ws.microsoft.com" dir=out action=block remoteip=134.170.115.60 enable=yes
netsh advfirewall firewall add rule name="telemetry_pre.footprintpredict.com" dir=out action=block remoteip=204.79.197.200 enable=yes
netsh advfirewall firewall add rule name="telemetry_i1.services.social.microsoft.com" dir=out action=block remoteip=104.82.22.249 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.windows.com" dir=out action=block remoteip=134.170.185.70 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.microsoft-hohm.com" dir=out action=block remoteip=64.4.6.100,65.55.39.10 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.search.microsoft.com" dir=out action=block remoteip=157.55.129.21 enable=yes
netsh advfirewall firewall add rule name="telemetry_rad.msn.com" dir=out action=block remoteip=207.46.194.25 enable=yes
netsh advfirewall firewall add rule name="telemetry_preview.msn.com" dir=out action=block remoteip=23.102.21.4 enable=yes
netsh advfirewall firewall add rule name="telemetry_dart.l.doubleclick.net" dir=out action=block remoteip=173.194.113.220,173.194.113.219,216.58.209.166 enable=yes
netsh advfirewall firewall add rule name="telemetry_ads.msn.com" dir=out action=block remoteip=157.56.91.82,157.56.23.91,104.82.14.146,207.123.56.252,185.13.160.61,8.254.209.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_a.ads1.msn.com" dir=out action=block remoteip=198.78.208.254,185.13.160.61 enable=yes
netsh advfirewall firewall add rule name="telemetry_global.msads.net.c.footprint.net" dir=out action=block remoteip=185.13.160.61,8.254.209.254,207.123.56.252 enable=yes
:: netsh advfirewall firewall add rule name="telemetry_az361816.vo.msecnd.net" dir=out action=block remoteip=68.232.34.200 enable=yes - ломает установку расширений vscode
netsh advfirewall firewall add rule name="telemetry_oca.telemetry.microsoft.com.nsatc.net" dir=out action=block remoteip=65.55.252.63 enable=yes
netsh advfirewall firewall add rule name="telemetry_reports.wes.df.telemetry.microsoft.com" dir=out action=block remoteip=65.52.100.91 enable=yes
netsh advfirewall firewall add rule name="telemetry_ssw.live.com" dir=out action=block remoteip=207.46.101.29 enable=yes
netsh advfirewall firewall add rule name="telemetry_msnbot-65-55-108-23.search.msn.com" dir=out action=block remoteip=65.55.108.23 enable=yes
netsh advfirewall firewall add rule name="telemetry_a23-218-212-69.deploy.static.akamaitechnologies.com" dir=out action=block remoteip=23.218.212.69 enable=yes

:: блокируем входящие подключения


netsh advfirewall firewall add rule name="telemetry_104.96.147.3" dir=in action=block remoteip=104.96.147.3 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.30.202" dir=in action=block remoteip=134.170.30.202 enable=yes
netsh advfirewall firewall add rule name="telemetry_137.116.81.24" dir=in action=block remoteip=137.116.81.24 enable=yes
netsh advfirewall firewall add rule name="telemetry_137.117.235.16" dir=in action=block remoteip=137.117.235.16 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.165.248" dir=in action=block remoteip=134.170.165.248 enable=yes
netsh advfirewall firewall add rule name="telemetry_134.170.165.253" dir=in action=block remoteip=134.170.165.253 enable=yes
netsh advfirewall firewall add rule name="telemetry_111.221.29.253" dir=in action=block remoteip=111.221.29.253 enable=yes
netsh advfirewall firewall add rule name="telemetry_111.221.64.0-111.221.127.255" dir=in action=block remoteip=111.221.64.0-111.221.127.255 enable=yes
netsh advfirewall firewall add rule name="telemetry_131.253.40.37" dir=in action=block remoteip=131.253.40.37 enable=yes
netsh advfirewall firewall add rule name="telemetry_vortex.data.microsoft.com" dir=in action=block remoteip=191.232.139.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_telecommand.telemetry.microsoft.com" dir=in action=block remoteip=65.55.252.92 enable=yes
netsh advfirewall firewall add rule name="telemetry_sqm.telemetry.microsoft.com" dir=in action=block remoteip=65.55.252.93 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.telemetry.microsoft.com" dir=in action=block remoteip=65.55.252.43,65.52.108.29 enable=yes
netsh advfirewall firewall add rule name="telemetry_redir.metaservices.microsoft.com" dir=in action=block remoteip=194.44.4.200,194.44.4.208 enable=yes
netsh advfirewall firewall add rule name="telemetry_choice.microsoft.com" dir=in action=block remoteip=157.56.91.77 enable=yes
netsh advfirewall firewall add rule name="telemetry_df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.7 enable=yes
netsh advfirewall firewall add rule name="telemetry_reports.wes.df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.91 enable=yes
netsh advfirewall firewall add rule name="telemetry_wes.df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.93 enable=yes
netsh advfirewall firewall add rule name="telemetry_services.wes.df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.92 enable=yes
netsh advfirewall firewall add rule name="telemetry_sqm.df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.94 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.9 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.ppe.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.11 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.appex.bing.net" dir=in action=block remoteip=168.63.108.233 enable=yes
netsh advfirewall firewall add rule name="telemetry_telemetry.urs.microsoft.com" dir=in action=block remoteip=157.56.74.250 enable=yes
netsh advfirewall firewall add rule name="telemetry_settings-sandbox.data.microsoft.com" dir=in action=block remoteip=111.221.29.177 enable=yes
netsh advfirewall firewall add rule name="telemetry_vortex-sandbox.data.microsoft.com" dir=in action=block remoteip=64.4.54.32 enable=yes
netsh advfirewall firewall add rule name="telemetry_survey.watson.microsoft.com" dir=in action=block remoteip=207.68.166.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.live.com" dir=in action=block remoteip=207.46.223.94 enable=yes
netsh advfirewall firewall add rule name="telemetry_watson.microsoft.com" dir=in action=block remoteip=65.55.252.71 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe2.ws.microsoft.com" dir=in action=block remoteip=64.4.54.22 enable=yes
netsh advfirewall firewall add rule name="telemetry_corpext.msitadfs.glbdns2.microsoft.com" dir=in action=block remoteip=131.107.113.238 enable=yes
netsh advfirewall firewall add rule name="telemetry_compatexchange.cloudapp.net" dir=in action=block remoteip=23.99.10.11 enable=yes
:: netsh advfirewall firewall add rule name="telemetry_cs1.wpc.v0cdn.net" dir=in action=block remoteip=68.232.34.200 enable=yes - ломает установку расширений vscode
netsh advfirewall firewall add rule name="telemetry_a-0001.a-msedge.net" dir=in action=block remoteip=204.79.197.200 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe2.update.microsoft.com.akadns.net" dir=in action=block remoteip=64.4.54.22 enable=yes
netsh advfirewall firewall add rule name="telemetry_sls.update.microsoft.com.akadns.net" dir=in action=block remoteip=157.56.77.139 enable=yes
netsh advfirewall firewall add rule name="telemetry_fe2.update.microsoft.com.akadns.net" dir=in action=block remoteip=134.170.58.121,134.170.58.123,134.170.53.29,66.119.144.190,134.170.58.189,134.170.58.118,134.170.53.30,134.170.51.190 enable=yes
netsh advfirewall firewall add rule name="telemetry_diagnostics.support.microsoft.com" dir=in action=block remoteip=157.56.121.89 enable=yes
netsh advfirewall firewall add rule name="telemetry_corp.sts.microsoft.com" dir=in action=block remoteip=131.107.113.238 enable=yes
netsh advfirewall firewall add rule name="telemetry_statsfe1.ws.microsoft.com" dir=in action=block remoteip=134.170.115.60 enable=yes
netsh advfirewall firewall add rule name="telemetry_pre.footprintpredict.com" dir=in action=block remoteip=204.79.197.200 enable=yes
netsh advfirewall firewall add rule name="telemetry_i1.services.social.microsoft.com" dir=in action=block remoteip=104.82.22.249 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.windows.com" dir=in action=block remoteip=134.170.185.70 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.microsoft-hohm.com" dir=in action=block remoteip=64.4.6.100,65.55.39.10 enable=yes
netsh advfirewall firewall add rule name="telemetry_feedback.search.microsoft.com" dir=in action=block remoteip=157.55.129.21 enable=yes
netsh advfirewall firewall add rule name="telemetry_rad.msn.com" dir=in action=block remoteip=207.46.194.25 enable=yes
netsh advfirewall firewall add rule name="telemetry_preview.msn.com" dir=in action=block remoteip=23.102.21.4 enable=yes
netsh advfirewall firewall add rule name="telemetry_dart.l.doubleclick.net" dir=in action=block remoteip=173.194.113.220,173.194.113.219,216.58.209.166 enable=yes
netsh advfirewall firewall add rule name="telemetry_ads.msn.com" dir=in action=block remoteip=157.56.91.82,157.56.23.91,104.82.14.146,207.123.56.252,185.13.160.61,8.254.209.254 enable=yes
netsh advfirewall firewall add rule name="telemetry_a.ads1.msn.com" dir=in action=block remoteip=198.78.208.254,185.13.160.61 enable=yes
netsh advfirewall firewall add rule name="telemetry_global.msads.net.c.footprint.net" dir=in action=block remoteip=185.13.160.61,8.254.209.254,207.123.56.252 enable=yes
:: netsh advfirewall firewall add rule name="telemetry_az361816.vo.msecnd.net" dir=in action=block remoteip=68.232.34.200 enable=yes - ломает установку расширений vscode
netsh advfirewall firewall add rule name="telemetry_oca.telemetry.microsoft.com.nsatc.net" dir=in action=block remoteip=65.55.252.63 enable=yes
netsh advfirewall firewall add rule name="telemetry_reports.wes.df.telemetry.microsoft.com" dir=in action=block remoteip=65.52.100.91 enable=yes
netsh advfirewall firewall add rule name="telemetry_ssw.live.com" dir=in action=block remoteip=207.46.101.29 enable=yes
netsh advfirewall firewall add rule name="telemetry_msnbot-65-55-108-23.search.msn.com" dir=in action=block remoteip=65.55.108.23 enable=yes
netsh advfirewall firewall add rule name="telemetry_a23-218-212-69.deploy.static.akamaitechnologies.com" dir=in action=block remoteip=23.218.212.69 enable=yes

:: блокировка телеметрии в планировщике

schtasks /Change /TN "Microsoft\Windows\AppID\SmartScreenSpecific" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\AitAgent" /Disable
schtasks /Change /TN "Microsoft\Windows\Autochk\Proxy" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\BthSQM" /Disable
schtasks /Change /TN "Microsoft\Windows\CloudExperienceHost\CreateObjectTask" /Disable
schtasks /Change /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /Disable
schtasks /Change /TN "Microsoft\Windows\Maintenance\WinSAT" /Disable
schtasks /Change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /Disable
schtasks /Change /TN "Microsoft\Windows\Shell\FamilySafetyMonitor" /Disable
schtasks /Change /TN "Microsoft\Windows\Shell\FamilySafetyRefresh" /Disable
schtasks /Change /TN "Microsoft\Windows\IME\SQM data sender" /Disable
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentFallBack" /Disable
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentLogOn" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /Disable
schtasks /Change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /Disable
schtasks /Change /TN "Microsoft\Windows\PI\Sqm-Tasks" /Disable
schtasks /Change /TN "Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem" /Disable

:: Отключение и удаление DiagTrack и dmwappushservice

sc stop DiagTrack
sc stop dmwappushservice
sc delete DiagTrack
sc delete dmwappushservice
